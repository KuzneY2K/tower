import{A as c,m as y,_ as B,n as T,u as S,r as k,b as A,d as v,P as r,q as w,M as D,i as x,f as M,o as a,c as i,a as t,s as _,w as u,h as q,v as L,t as l,F as f,g as I,j as N,x as R,p as P,k as V}from"./index-39d7d102.js";class E{constructor(o){this.id=o.id,this.creatorId=o.creatorId,this.eventId=o.eventId,this.body=o.body,this.isAttending=o.isAttending,this.creator=o.creator,this.event=o.even,this.createdAt=new Date(o.createdAt).toLocaleDateString([],{hour:"2-digit",minute:"2-digit"})}}class j{async getEventComments(o){c.eventComments=null;const d=await y.get(`api/events/${o}/comments`);c.eventComments=d.data.map(e=>new E(e))}async deleteComment(o){await y.delete(`api/comments/${o}`);let d=c.eventComments.filter(e=>e.id!=o);c.eventComments=d}async createComment(o){const d=await y.post("api/comments",o);let e=new E(d.data);c.eventComments.push(e)}}const g=new j;const U={setup(){const s=T(),o=S();let d=k({}),e=k({});async function b(){try{await w.getEventById(s.params.eventId)}catch(n){r.error(n)}}async function p(){try{await g.getEventComments(s.params.eventId)}catch(n){r.error(n)}}async function h(){try{await x.getEventTickets(s.params.eventId)}catch(n){r.error(n)}}return A(()=>{b(),p(),h()}),{event:v(()=>c.activeEvent),comments:v(()=>c.eventComments.reverse()),tickets:v(()=>c.eventTickets),account:v(()=>c.account),capacity:v(()=>c.activeEvent.capacity),ticketCount:v(()=>c.activeEvent.ticketCount),hasTicket:v(()=>c.eventTickets.find(n=>n.accountId==c.account.id)),getEventComments:p,getEventTickets:h,reqBody:d,ticketBody:e,async cancelEvent(){try{await r.confirm("Are you sure you want to cancel this event?")&&(await w.cancelEvent(s.params.eventId),o.push({name:"Home",path:"/"}),r.toast("Event Cancelled."))}catch(n){r.error(n)}},async deleteComment(n){try{await r.confirm("Delete Comment?")?(await g.deleteComment(n),r.toast("Comment Removed.")):r.toast("Deletion cancelled.")}catch(C){r.error(C)}},async createComment(){try{d.value.eventId=s.params.eventId,d.value.event=this.event,await g.createComment(d.value),D.getOrCreateInstance("#commentModal").hide(),d.value={}}catch(n){r.error(n)}},async createTicket(){try{e.value.eventId=s.params.eventId,e.value.event=this.event,e.value.accountId=this.account.id,e.value.profile=this.account,await x.createTicket(e.value),e.value={},b()}catch(n){r.error(n)}}}}},m=s=>(P("data-v-2bd21c79"),s=s(),V(),s),F={key:0,class:"row p-0 m-0 d-flex flex-column flex-md-row align-items-md-start align-items-center container-fluid position-relative mt-5"},G={class:"btn-container p-0 m-0 position-absolute"},H={key:0,type:"button",class:"btn comment-btn btn-grad p-0 m-0 px-4 py-2 border border-1 border-white elevation-5 position-fixed","data-bs-toggle":"modal","data-bs-target":"#commentModal",title:"Comment"},O=m(()=>t("i",{class:"mdi mdi-pencil-plus fs-2"},null,-1)),W=[O],X={key:0,class:"btn-container p-0 m-0 position-absolute"},z={key:0,class:"tixcontainer p-0 m-0"},J=m(()=>t("i",{class:"mdi mdi-ticket fs-2"},null,-1)),K=[J],Q={class:"btn-container p-0 m-0 position-absolute"},Y={key:0,class:"delcontainer p-0 m-0"},Z=m(()=>t("i",{class:"mdi mdi-close-thick fs-2"},null,-1)),$=[Z],ee={class:"modal fade",id:"commentModal",tabindex:"-1","aria-labelledby":"commentModalLabel","aria-hidden":"true"},te={class:"modal-dialog"},ne={class:"modal-content"},oe=m(()=>t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"commentModalLabel"},"Create Comment"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),ae={class:"modal-body mb-3"},se={class:"mb-3"},ie=m(()=>t("label",{for:"body",class:"form-label"},"What's on your mind?",-1)),ce=m(()=>t("button",{type:"submit",class:"btn btn-grad px-4 py-2 border border-1 border-white elevation-5"},"Submit",-1)),de={class:"col-6 p-0 m-0 d-flex flex-column align-items-md-start align-items-center"},re={class:"div pattern-diagonal-lines-sm gray-lighter text-black p-0 m-0 coverImgContainer mt-3 animate__animated animate__fadeInLeft"},me=["src"],le={class:"col-6 p-0 m-0 d-flex flex-column align-items-md-start align-items-center info-col"},_e={class:"p-0 m-0 d-flex flex-row justify-content-md-end"},ve={class:"p-0 m-0 me-md-5 mt-md-5 my-3 animate__animated animate__fadeInLeftBig eventName"},he={class:"p-0 m-0 me-md-5 mt-0 my-3 animate__animated animate__fadeInRightBig"},ue={class:"p-0 m-0 me-md-5 mt-0 my-3 animate__animated animate__fadeInDownBig"},be={class:"mt-md-5 me-md-5 p-0 m-0 w-100 my-3 desc animate__animated animate__fadeInUpBig"},pe=m(()=>t("hr",null,null,-1)),ye={class:"mt-md-2 ms-md-5 animate__animated animate__fadeInUpBig"},fe={class:"col-12 p-0 m-0 d-flex flex-row justify-content-center attendeeContainer mt-md-3"},ge=m(()=>t("hr",null,null,-1)),Ce={key:0,class:"col-md-6 col-10 p-0 m-0 d-flex flex-column align-items-start align-items-md-start ms-md-5 mx-auto position-relative"},ke=["onClick"],we={class:"div p-0 m-0 commentContainer border border-2 border-black p-4 w-100 rounded"},xe={class:"div comment-head p-0 m-0 d-flex flex-row align-items-center"},Ie=["src"],Ee={class:"div comment-head-info"},Be={class:"p-0 m-0 ms-4"},Te={class:"p-0 m-0 ms-4 mt-1"},Se={class:"p-0 m-0 mt-4 fs-5"},Ae=m(()=>t("i",{class:"mdi mdi-format-quote-open"},null,-1)),De=m(()=>t("i",{class:"mdi mdi-format-quote-close"},null,-1));function Me(s,o,d,e,b,p){const h=M("AttendeeBubble");return a(),i(f,null,[e.event&&!e.event.isCanceled?(a(),i("section",F,[t("div",G,[e.account.id?(a(),i("button",H,W)):_("",!0)]),e.capacity-e.ticketCount>0?(a(),i("div",X,[e.tickets?(a(),i("div",z,[e.account.id&&!e.hasTicket?(a(),i("button",{key:0,type:"button",class:"btn attend-btn btn-grad p-0 m-0 px-4 py-2 border border-1 border-white elevation-5 position-fixed",onClick:o[0]||(o[0]=u(n=>e.createTicket(),["prevent"])),title:"Attend Event"},K)):_("",!0)])):_("",!0)])):_("",!0),t("div",Q,[e.event.creatorId==e.account.id?(a(),i("div",Y,[t("button",{type:"button",class:"btn del-btn btn-grad p-0 m-0 px-4 py-2 border border-1 border-white elevation-5 position-fixed",onClick:o[1]||(o[1]=u(n=>e.cancelEvent(),["prevent"])),title:"Cancel Event"},$)])):_("",!0)]),t("div",ee,[t("div",te,[t("div",ne,[oe,t("div",ae,[t("form",{class:"w-100",onSubmit:o[3]||(o[3]=u(n=>e.createComment(),["prevent"]))},[t("div",se,[ie,q(t("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=n=>e.reqBody.body=n),class:"form-control p-3",id:"body",required:"",minlength:"1",maxlength:"250"},null,512),[[L,e.reqBody.body]])]),ce],32)])])])]),t("div",de,[t("div",re,[t("img",{src:e.event.coverImg,alt:"event coverimg",class:"coverImg ms-md-5 mt-md-5 border border-2 border-black elevation-5 animate__animated animate__fadeIn"},null,8,me)])]),t("div",le,[t("div",_e,[t("h2",ve,l(e.event.name),1)]),t("h3",he,l(e.event.location),1),t("h5",ue,"Event created by: "+l(e.event.creator.name),1),t("h5",be,l(e.event.description),1),pe,(a(),i("h4",{class:"p-0 m-0 me-md-5 mt-md-2 my-3 animate__animated animate__fadeInDownBig",key:e.event.ticketCount},"Tickets left: "+l(e.capacity-e.ticketCount),1)),t("h3",ye,"STARTING at "+l(e.event.startDate),1),t("div",fe,[(a(!0),i(f,null,I(e.tickets,n=>(a(),N(h,{key:n.id,ticket:n},null,8,["ticket"]))),128))]),ge])])):_("",!0),(a(!0),i(f,null,I(e.comments,n=>(a(),i("section",{class:"row p-0 m-0 comments mb-5 mt-4",key:n},[e.event&&!e.event.isCanceled?(a(),i("div",Ce,[n.creator.id==e.account.id?(a(),i("button",{key:0,class:"btn btn-secondary rounded position-absolute deleteBtn",onClick:u(C=>e.deleteComment(n.id),["prevent"])},"X",8,ke)):_("",!0),t("div",we,[t("div",xe,[t("img",{src:n.creator.picture,alt:"",class:"rounded rounded-pill commentpic",height:"60",width:"60"},null,8,Ie),t("div",Ee,[t("h5",Be,l(n.creator.name)+" says...",1),t("span",Te,l(n.createdAt),1)])]),t("p",Se,[Ae,R(l(n.body),1),De])])])):_("",!0)]))),128))],64)}const Le=B(U,[["render",Me],["__scopeId","data-v-2bd21c79"]]);export{Le as default};
